<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Modal RN - Corrigido</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Teste do Modal de Adicionar RN - CORRIGIDO</h1>
        <p class="text-success">✅ Correções aplicadas:</p>
        <ul>
            <li>Seletores JavaScript corrigidos</li>
            <li>Validação de campos obrigatórios ajustada</li>
            <li>Proteção contra fechamento do modal melhorada</li>
            <li>Logs de debug adicionados</li>
        </ul>
        
        <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalAdicionarRN">
            <i class="fas fa-baby"></i> Testar Modal RN Corrigido
        </button>
        
        <div class="mt-3">
            <h5>Como testar:</h5>
            <ol>
                <li>Clique no botão acima</li>
                <li>Preencha os campos obrigatórios: Nome, Sexo, Data de Nascimento, Raça/Cor</li>
                <li>Clique em "Próximo"</li>
                <li>Verifique se o modal permanece aberto e muda para a segunda aba</li>
            </ol>
        </div>
    </div>

    <!-- Modal para Adicionar RN -->
    <div class="modal fade" id="modalAdicionarRN" tabindex="-1" aria-labelledby="modalAdicionarRNLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalAdicionarRNLabel">
                        <i class="fas fa-baby me-2"></i>Adicionar Recém-Nascido
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <!-- Abas para as etapas do processo -->
                    <ul class="nav nav-tabs" id="adicionarRNTabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="dados-rn-tab" data-bs-toggle="tab" href="#dados-rn" role="tab" aria-controls="dados-rn" aria-selected="true">
                                1. Dados do RN
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link disabled" id="internacao-rn-tab" data-bs-toggle="tab" href="#internacao-rn" role="tab" aria-controls="internacao-rn" aria-selected="false">
                                2. Dados da Internação
                            </a>
                        </li>
                    </ul>
                    
                    <div class="tab-content mt-4" id="adicionarRNTabsContent">
                        <!-- Etapa 1: Dados do RN -->
                        <div class="tab-pane fade show active" id="dados-rn" role="tabpanel" aria-labelledby="dados-rn-tab">
                            <div class="alert alert-info mb-4">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Teste:</strong> Preencha os campos obrigatórios e clique em Próximo
                            </div>
                            
                            <form id="dadosRNForm">
                                <div class="row">
                                    <div class="form-group col-md-8">
                                        <label for="nomeRN" class="form-label">Nome Completo do RN*</label>
                                        <input type="text" class="form-control" id="nomeRN" name="nomeRN" placeholder="RN DE TESTE" required>
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label for="sexoRN" class="form-label">Sexo*</label>
                                        <select class="form-control" id="sexoRN" name="sexoRN" required>
                                            <option value="">Selecione...</option>
                                            <option value="M">Masculino</option>
                                            <option value="F">Feminino</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="form-group col-md-6">
                                        <label for="dataNascimentoRN" class="form-label">Data de Nascimento*</label>
                                        <input type="date" class="form-control" id="dataNascimentoRN" name="dataNascimentoRN" required>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="corRN" class="form-label">Raça/Cor*</label>
                                        <select class="form-control" id="corRN" name="corRN" required>
                                            <option value="">Selecione...</option>
                                            <option value="Branca">Branca</option>
                                            <option value="Parda">Parda</option>
                                            <option value="Preta">Preta</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="form-group col-md-6">
                                        <label for="pesoRN" class="form-label">Peso ao Nascer (gramas) - Opcional</label>
                                        <input type="number" class="form-control" id="pesoRN" name="pesoRN" placeholder="Ex: 3200">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="alturaRN" class="form-label">Altura (cm) - Opcional</label>
                                        <input type="number" class="form-control" id="alturaRN" name="alturaRN" placeholder="Ex: 50">
                                    </div>
                                </div>
                                
                                <!-- Campos ocultos para simular dados da mãe -->
                                <input type="hidden" id="filiacaoRN" value="MÃE TESTE">
                                <input type="hidden" id="telefoneRN" value="(11) 99999-9999">
                                <input type="hidden" id="enderecoRN" value="Rua Teste, 123">
                                <input type="hidden" id="bairroRN" value="Centro">
                                <input type="hidden" id="municipioRN" value="São Paulo">
                                
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="submit" class="btn btn-success">
                                        Próximo <i class="fas fa-arrow-right ms-1"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Etapa 2: Dados da Internação -->
                        <div class="tab-pane fade" id="internacao-rn" role="tabpanel" aria-labelledby="internacao-rn-tab">
                            <div class="alert alert-success mb-4">
                                <i class="fas fa-check-circle me-2"></i>
                                <strong>Sucesso!</strong> A transição funcionou corretamente!
                            </div>
                            
                            <p>Esta é a segunda aba. Se você chegou aqui, significa que o bug foi corrigido!</p>
                            
                            <form id="internacaoRNForm">
                                <div class="form-group">
                                    <label>Teste concluído com sucesso!</label>
                                    <textarea class="form-control" rows="3" readonly>
As correções implementadas:
1. Seletores JavaScript corrigidos
2. Validação ajustada para campos obrigatórios
3. Proteção contra fechamento do modal
4. Logs de debug melhorados
                                    </textarea>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-4">
                                    <button type="button" class="btn btn-secondary" onclick="$('#dados-rn-tab').click()">
                                        <i class="fas fa-arrow-left me-1"></i> Voltar
                                    </button>
                                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">
                                        <i class="fas fa-check me-1"></i> Fechar Teste
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/modal-rn-fix-ultimate.js"></script>
    
    <!-- Campo oculto para simular paciente_id -->
    <input type="hidden" id="paciente_id" value="123">
    
    <script>
        // Definir data de hoje como padrão
        document.addEventListener('DOMContentLoaded', function() {
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('dataNascimentoRN').value = hoje;
        });
        
        // Log de teste
        console.log('🧪 Página de teste carregada - Modal RN Fix Ultimate');
    </script>
</body>
</html> 